{"version":3,"sources":["app.min.js"],"names":["angular","module","config","$stateProvider","$locationProvider","$urlRouterProvider","state","url","templateUrl","controller","otherwise","html5Mode","$scope","year","Date","getFullYear","$rootScope","prismHighlight","Prism","highlightAll","tinymceUsage","setup","editor","on","event","keyCode","shiftKey","execCommand","preventDefault","height","plugins","toolbar","valid_elements","$on","evt","directive","$timeout","restrict","link","scope","element","attr","$last","$emit","onFinishRepeat","authentication","meanData","error","login","user","then","window","location","href","register","createUser","userr","res","alert","data","message","err","statusText","$location","$sce","$stateParams","docId","id","isLoggedIn","getDocCategories","categories","getDocByCategory","category","docs","totalItems","length","currentPage","updateDocList","submitDoc","addD","related","selRelateds","forEach","elem","push","currentUser","author","name","createDoc","showAdd","getQuestionCategory","questionId","getQuestionsByCategory","questions","updateQuestionList","submitQuestion","addQ","createQuestion","clearPanels","filteredQuestions","filteredDocs","$watch","keyword","doSearch","selector","getQuestionByKeyword","getDocByKeyword","service","$http","$window","$q","saveToken","token","localStorage","getToken","payload","split","atob","JSON","parse","exp","now","defer","getUserById","_id","resolve","promise","post","success","logout","removeItem","getAllUsers","get","newUser","updateUser","put","deleteUser","getQuestionById","newQuestion","updateQuestion","deleteQuestion","getDocById","doc","updateDoc","deleteDoc","getRelatedByKeyword","p","Promise","reject","all","require","numPerPage","showAnswer","doDeepCopy","backupDoc","copy","begin","end","slice","resetUpdateDoc","confirm","isUpdateDoc","Object","keys","property","setTimeout","selRelatedsUpdate","value","isActive","viewLocation","path","question","answer","isUpdateQuestion","removeCurSelRelated","index","splice","addThisRelated","thisRelated","i","title","searchRelatedKeyword","rest","relateds","object","obj","relatedsUpdate"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n  angular.module('app', ['ui.router', 'ngAnimate', 'ui.bootstrap', 'ngSanitize', 'ui.tinymce'])\n  .config(['$stateProvider', '$locationProvider', '$urlRouterProvider',\n    function ($stateProvider, $locationProvider, $urlRouterProvider) {\n      $stateProvider\n        .state('root', {\n          url: '/',\n          templateUrl: '/home/home.view.html',\n          controller: \"homeCtrl\"\n        })\n        .state('login/register', {\n          url: '/login', // can't named \"auth\"\n          templateUrl: \"/auth/auth.view.html\",\n          controller: \"loginCtrl\"\n        })\n        .state('documents', {\n          url: '/doc?id',\n          templateUrl: \"/document/document.view.html\",\n          controller: \"docCtrl\"\n        })\n        .state('questions', {\n          url: '/q?id',\n          templateUrl: \"/question/question.view.html\",\n          controller: \"questionsCtrl\"\n        });\n        $urlRouterProvider.otherwise('/');\n\n      $locationProvider.html5Mode(true);\n\n  }]).controller('footerCtrl', ['$scope', function ($scope) {\n    $scope.year = new Date().getFullYear();\n  }]).controller('mainCtrl', ['$scope', '$rootScope', function($scope, $rootScope){\n    $rootScope.prismHighlight = function(){\n      Prism.highlightAll();\n    };\n\n    $rootScope.tinymceUsage = {\n\t  setup: function(editor){\n\t\t  editor.on('keydown', function(event){\n\t\t\t if(event.keyCode == 9){\n\t\t\t\t if(event.shiftKey){\n\t\t\t\t\t editor.execCommand('Outdent');\n\t\t\t\t }else{\n\t\t\t\t\t editor.execCommand('Indent');\n\t\t\t\t }\n\t\t\t\t event.preventDefault();\n\t\t\t\t return false;\n\t\t\t } \n\t\t  });\n\t  },\n      height: 250,\n      plugins: 'link image codesample advlist code preview',\n      toolbar: 'undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | codesample | link image',\n      valid_elements : '*[*]'\n    };\n    $rootScope.$on('onFinishRepeat', function(evt){\n      $scope.prismHighlight();\n    });\n    \n  }]).directive('onFinishRepeat', ['$timeout', function($timeout){\n    return {\n      restrict: 'A',\n      link: function(scope, element, attr){\n        if(scope.$last === true){\n          $timeout(function(){\n            scope.$emit(attr.onFinishRepeat);\n          });\n        }\n      }\n    }\n  }]);\n})();\n(function () {\n  angular.module('app')\n    .controller('loginCtrl', ['$scope', 'authentication', 'meanData', function ($scope, authentication, meanData) {\n\n      $scope.error = false;\n\n      $scope.login = function () {\n        authentication.login($scope.user)\n          .error(function () {\n            $scope.error = true;\n          })\n          .then(function () {\n            \n            window.location.href = \"/\";\n          })\n      };\n\n      $scope.register = function () {\n        meanData.createUser($scope.userr).then(function (res) {\n          alert(res.data.message);\n          $scope.user = $scope.userr;\n          $scope.login();\n        },function(err){\n          alert(err.statusText);\n        })\n      };\n\n    }])\n})();\n(function () {\r\n  angular.module('app').controller('docCtrl', ['$scope', 'meanData', 'authentication', '$location', '$sce', '$stateParams',\r\n    function ($scope, meanData, authentication, $location, $sce, $stateParams) {\r\n\r\n        $scope.meanData = meanData;\r\n        $scope.docId = $stateParams.id;\r\n\r\n        $scope.isLoggedIn = authentication.isLoggedIn();\r\n\r\n      \t$scope.getDocCategories = function(){\r\n      \t\tmeanData.getDocCategories().then(function (data) {\r\n          \t\t$scope.categories = data.data;\r\n      \t\t});      \t\r\n        };\r\n\r\n\r\n    \t\t$scope.getDocByCategory = function(category){\r\n    \t\t\tmeanData.getDocByCategory(category).then(function (data) {\r\n  \t\t\t\t    $scope.docs = data.data;\r\n\t            $scope.totalItems = data.data.length;\r\n\t            $scope.currentPage = 1;\r\n\t            $scope.updateDocList();\r\n    \t\t\t});\r\n    \t\t};\r\n\r\n      \t$scope.submitDoc = function(){\r\n          if($scope.addD){\r\n            $scope.addD.related = [];\r\n            $scope.selRelateds.forEach(function(elem){\r\n              $scope.addD.related.push(elem);\r\n            });\r\n\r\n            authentication.currentUser().then(function(res){\r\n              $scope.addD.author = res.name;\r\n\r\n              meanData.createDoc($scope.addD).then(function (res) {\r\n                alert(res.data.message);\r\n                $scope.getDocCategories($scope.addD.category);\r\n                $scope.getDocByCategory();\r\n                $scope.showAdd = false;\r\n                $scope.addD = null; // reset add document panel\r\n                }, function(res){\r\n                alert(res.statusText);\r\n              });\r\n            });\r\n          }\r\n      \t};\r\n    }]);\r\n})();\n(function () {\r\n  angular.module('app').controller('questionsCtrl', ['$scope', 'meanData', 'authentication', '$location', '$sce', '$stateParams',\r\n    function ($scope, meanData, authentication, $location, $sce, $stateParams) {\r\n\r\n        $scope.meanData = meanData;\r\n\r\n      \t$scope.getQuestionCategory = function(){\r\n      \t\tmeanData.getQuestionCategory().then(function (data) {\r\n          \t$scope.categories = data.data;\r\n      \t\t});      \t\r\n        };\r\n        // receive question id\r\n        $scope.questionId = $stateParams.id;\r\n\r\n    \t\t$scope.getQuestionsByCategory = function(category){\r\n    \t\t\tmeanData.getQuestionsByCategory(category).then(function (data) { // then -> .data // success -> .\r\n            \r\n    \t\t\t\t$scope.questions = data.data;\r\n            $scope.totalItems = data.data.length;\r\n            $scope.currentPage = 1;\r\n            $scope.updateQuestionList();\r\n    \t\t\t});\r\n    \t\t};\r\n\r\n      \t$scope.submitQuestion = function(){\r\n          if($scope.addQ){\r\n            $scope.addQ.related = [];\r\n            $scope.selRelateds.forEach(function(elem){\r\n              $scope.addQ.related.push(elem);\r\n            });\r\n            meanData.createQuestion($scope.addQ).then(function (res) {\r\n              alert(res.data.message);\r\n              $scope.getQuestionsByCategory($scope.addQ.category);\r\n              $scope.getQuestionCategory();\r\n              $scope.showAdd = false;\r\n            }, function(res){\r\n            alert(res.statusText);\r\n            });\r\n          }\r\n      \t};\r\n    }]);\r\n})();\n(function () {\n  angular.module('app').controller('homeCtrl', ['$scope', 'meanData', 'authentication',\n    function ($scope, meanData, authentication) {\n\n      function clearPanels(){\n        $scope.filteredQuestions = null;\n        $scope.filteredDocs = null;\n      }\n\n      $scope.meanData = meanData;\n\n      $scope.$watch('selector', function(){\n        $scope.keyword = \"\";\n        clearPanels();\n      });\n      \n      $scope.doSearch = function(){\n        if($scope.keyword && $scope.selector){\n          if($scope.selector == 'Quiz'){\n            meanData.getQuestionByKeyword($scope.keyword).then(function (res){\n              $scope.questions = res.data;\n              $scope.totalItems = res.data.length;\n              $scope.currentPage = 1;\n              $scope.updateQuestionList();\n            });\n          }\n          if($scope.selector == 'Doc'){\n            meanData.getDocByKeyword($scope.keyword).then(function (res){\n              $scope.docs = res.data;\n              $scope.totalItems = res.data.length;\n              $scope.currentPage = 1;\n              $scope.updateDocList();\n            });\n          }\n        }else{clearPanels();}\n      };\n      \n    }]);\n})();\n(function () {\n  angular.module('app').service('authentication', ['$http', '$window', 'meanData', '$q', function ($http, $window, meanData, $q) {\n\n    var saveToken = function (token) {\n      $window.localStorage['mean-token'] = token;\n    };\n\n    var getToken = function () {\n      return $window.localStorage['mean-token'];\n    };\n\n    var isLoggedIn = function () {\n      var token = getToken();\n      var payload;\n\n      if(token){\n        payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n\n        return payload.exp > Date.now() / 1000;\n      }else{\n        return false;\n      }\n    };\n\n    var currentUser = function() {\n      if(isLoggedIn()){\n        var token = getToken();\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        var defer = $q.defer();\n        meanData.getUserById(payload._id).then(function(res){\n          defer.resolve(res.data);\n        });\n        return defer.promise;\n      }\n    };\n\n    var login = function (user) {\n      return $http.post('/api/login', user).success(function (data) {\n        saveToken(data.token);\n      })\n    };\n\n    var logout = function () {\n      $window.localStorage.removeItem('mean-token');\n    };\n\n    return {\n      login: login,\n      isLoggedIn: isLoggedIn,\n      currentUser: currentUser,\n      logout: logout\n    }\n\n  }])\n  \n})();\n(function () {\n  angular.module('app').service('meanData', ['$http', '$q', function meanData($http, $q) {\n\n    var getAllUsers = function () {\n      return $http.get('/api/user');\n    };\n\n    var getUserById = function (id) {\n      return $http.get('/api/user/' + id);\n    };\n\n    var createUser = function (newUser) {\n      return $http.post('/api/user', newUser, {});\n    };\n\n    var updateUser = function (updateUser) {\n      return $http.put('/api/user', updateUser, {});\n    };\n\n    var deleteUser = function (id) {\n      return $http.delete('/api/user?id=' + id, {});\n    };\n\n    var getQuestionsByCategory = function(category){\n      return $http.get('/api/q/c/' + category); \n    };\n\n    var getQuestionByKeyword = function(keyword){\n      return $http.get('/api/s/q/' + keyword); \n    }\n\n    var getQuestionById = function(id){\n      return $http.get('/api/q/' + id); \n    };\n\n    var getQuestionCategory = function(){\n      return $http.get('/api/q');\n    };\n\n    var createQuestion = function (newQuestion) {\n      return $http.post('/api/q', newQuestion, {});\n    };\n\n    var updateQuestion = function (updateQuestion) {\n      return $http.put('/api/q', updateQuestion, {});\n    };\n\n    var deleteQuestion = function (id) {\n      return $http.delete('/api/q/' + id, {});\n    };\n\n    var getDocById = function(id){\n      return $http.get('/api/doc/' + id);\n    };\n\n    var getDocCategories = function(){\n      return $http.get('/api/doc');\n    };\n\n    var getDocByCategory = function(category){\n      return $http.get('/api/doc/c/' + category);\n    };\n\n    var createDoc = function(doc){\n      return $http.post('/api/doc', doc);\n    };\n\n    var updateDoc = function(doc){\n      return $http.put('/api/doc', doc);\n    };\n\n    var deleteDoc = function(id){\n      return $http.delete('/api/doc/' + id);\n    }\n\n    var getDocByKeyword = function(keyword){\n      return $http.get('/api/s/d/' + keyword + \"?need=\");\n    }\n\n    var getRelatedByKeyword = function(keyword){\n      var p =new Promise(function(resolve, reject){\n        $q.all([\n          $http.get('/api/s/d/' + keyword + \"?need=title+group\"),\n          $http.get('/api/s/q/' + keyword + \"?need=title+group\")\n        ]).then(function(res){\n          resolve(res);\n        });\n      });\n      return p;\n    }\n\n    return {\n      getAllUsers: getAllUsers,\n      createUser: createUser,\n      updateUser: updateUser,\n      deleteUser: deleteUser,\n      getUserById: getUserById,\n\n      getQuestionById: getQuestionById,\n      getQuestionCategory: getQuestionCategory,\n      getQuestionsByCategory: getQuestionsByCategory,\n      createQuestion: createQuestion,\n      updateQuestion: updateQuestion,\n      deleteQuestion: deleteQuestion,\n\n      getDocById: getDocById,\n      getDocCategories: getDocCategories,\n      getDocByCategory: getDocByCategory,\n      createDoc: createDoc,\n      updateDoc: updateDoc,\n      deleteDoc: deleteDoc,\n\n      getQuestionByKeyword: getQuestionByKeyword,\n      getDocByKeyword: getDocByKeyword,\n      getRelatedByKeyword: getRelatedByKeyword\n    }\n  }])\n})();\n(function () {\r\n\tangular.module('app').directive('listDoc', function () {\r\n\t\treturn {\r\n      \t\trestrict: 'E',\r\n      \t\trequire: '?ngModel',\r\n\t\t\tscope: false,\r\n      \t\ttemplateUrl: '/common/directives/list-document/list-document.view.html',\r\n      \t\tlink: function(scope, element, attr){\r\n      \t\t\tscope.numPerPage = 5;\r\n\r\n      \t\t\tif(scope.docId){\r\n      \t\t\t\tscope.meanData.getDocById(scope.docId).then(function(res){\r\n      \t\t\t\t\tscope.filteredDocs = [res.data];\r\n      \t\t\t\t\tscope.filteredDocs[0].showAnswer = true;\r\n      \t\t\t\t});\r\n      \t\t\t}\r\n\r\n      \t\t\tscope.doDeepCopy = function(doc){\r\n      \t\t\t\tscope.backupDoc = angular.copy(doc);\r\n      \t\t\t}\r\n\r\n\t\t\t\tscope.updateDocList = function(){\r\n\t\t\t\t\tvar begin = (scope.currentPage - 1) * scope.numPerPage;\r\n\t\t\t\t\tvar end = begin + scope.numPerPage;\r\n\t\t\t\t\tif(scope.docs){\r\n\t\t\t\t  \t\tscope.filteredDocs = scope.docs.slice(begin, end);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t    scope.$watch(\"currentPage + numPerPage\", scope.updateDocList);\r\n\r\n\t\t        scope.resetUpdateDoc = function(doc){\r\n\t\t          if(confirm(\"Are you sure to discard your records?\")){\r\n\t\t          \tscope.backupDoc.isUpdateDoc = false;\r\n\t\t          \t// doc = scope.backupDoc;\r\n\t\t          \t// doc.usage = scope.backupDoc.usage;\r\n\t\t          \t\r\n\t\t          \tObject.keys(doc).forEach(function(property){\r\n\t\t          \t\tdoc[property] = scope.backupDoc[property];\r\n\t\t          \t});\t          \r\n\t\t          \tsetTimeout(function(){\r\n\t\t          \t\tscope.prismHighlight();\r\n\t\t          \t});\r\n\t\t          }\r\n\t\t        }\r\n\r\n\t\t\t    scope.updateDoc = function(doc, selRelatedsUpdate){\r\n\t\t\t\t\tif(confirm(\"Are you sure to make a update?\")){\r\n\t\t\t\t\t\tdoc.related = [];\r\n\t\t          \t\tselRelatedsUpdate.forEach(function(elem){\r\n\t\t\t            \tdoc.related.push(elem);\r\n\t\t\t          \t});\r\n\t\t\t      \t\tscope.meanData.updateDoc(doc).then(function (res) {\r\n\t\t\t        \t\talert(res.data.message);\r\n\t\t\t        \t\tdoc.isUpdateDoc=false;\r\n\t\t\t        \t\tsetTimeout(function(){\r\n\t\t\t\t          \t\tscope.prismHighlight();\r\n\t\t\t\t          \t});\r\n\t\t\t      \t\t  }, function(res){\r\n\t\t\t      \t\t\talert(res.statusText);\r\n\t\t\t      \t\t});\r\n\t\t\t      \t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tscope.deleteDoc = function(doc){\r\n\t\t\t\t\tif(confirm(\"Are you sure to delete this document?\")){\r\n\t\t\t\t\t\tscope.meanData.deleteDoc(doc._id).then(function(res){\r\n\t\t\t\t\t\t\talert(res.data.message);\r\n\t\t\t\t\t\t\tscope.getDocByCategory(doc.category);\r\n\t\t\t\t\t\tscope.getDocCategories();\r\n\t\t\t\t\t\t},function(res){\r\n\t\t\t\t\t\t\talert(res.statusText);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n      \t\t}\r\n    \t}\r\n  \t})\r\n})();\n(function () {\n  angular.module('app').directive('navigation', function () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/common/directives/navigation/navigation.view.html'\n    }\n  }).controller('navCtrl', ['$scope', '$location', 'authentication', function($scope, $location, authentication){\n    $scope.logout = function () {\n      authentication.logout();\n      window.location.href = \"/\";\n    };\n    // get current user\n\tvar promise = authentication.currentUser();\n\tif(promise){\n\t\tpromise.then(function(value){\n\t    \t$scope.currentUser = value;\n\t    });\n\t}\n\t\n    $scope.isLoggedIn = authentication.isLoggedIn();\n    $scope.isActive = function(viewLocation){\n      return viewLocation === $location.path();\n    };\n  }])\n})();\n(function () {\n\tangular.module('app').directive('listQuestion', function () {\n\t\treturn {\n\t\t\tscope: false,\n      \t\trestrict: 'E',\n      \t\ttemplateUrl: '/common/directives/list-question/list-question.view.html',\n      \t\tlink: function(scope, element, attr){\n      \t\t\tscope.numPerPage = 5;\n\n      \t\t\t// receive question id\n\t\t        if(scope.questionId){\n\t\t    \t      scope.meanData.getQuestionById(scope.questionId).then(function(res){\n\t\t          \t\tscope.filteredQuestions = [res.data];\n\t\t          \t\tscope.showAnswer = !scope.showAnswer;\n\t\t          });\n\t\t        }\n\n\t\t\t\tscope.updateQuestionList = function(){\n\t\t\t\t\tvar begin = (scope.currentPage - 1) * scope.numPerPage;\n\t\t\t\t\tvar end = begin + scope.numPerPage;\n\t\t\t\t\tif(scope.questions){\n\t\t\t\t  \t\tscope.filteredQuestions = scope.questions.slice(begin, end);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t    scope.$watch('currentPage + numPerPage', scope.updateQuestionList);\n\n\t\t\t    scope.updateQuestion = function(question, updateQuestion){\n\t\t\t\t\tif(typeof updateQuestion !== 'undefined'){\n\t\t\t\t\t\tif(updateQuestion.answer.length > 0){\n\t\t\t\t\t\t\tquestion.answer = updateQuestion.answer;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(updateQuestion.author){\n\t\t\t\t\t\t\tif(updateQuestion.author.length > 0){\n\t\t\t\t\t\t\t\tquestion.author = updateQuestion.author;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.meanData.updateQuestion(question).then(function(res){\n\t\t\t\t\t\talert(res.data.message);\n\t\t\t\t\t\tquestion.isUpdateQuestion = false;\n\t\t\t\t\t}, function(res){\n\t\t\t\t\t\talert(res.statusText);\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tscope.deleteQuestion = function(question){\n\t\t\t\t\tif(confirm(\"Are you sure to delete this question?\")){\n\t\t\t\t\t\tscope.meanData.deleteQuestion(question._id).then(function(res){\n\t\t\t\t\t\t\talert(res.data.message);\n\t\t\t\t\t\t\tscope.getQuestionsByCategory(question.category);\n\t\t\t\t\t\tscope.getQuestionCategory();\n\t\t\t\t\t\t},function(res){\n\t\t\t\t\t\t\talert(res.statusText);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n      \t\t}\n    \t}\n  \t})\n})();\n(function(){\r\n\tangular.module('app').directive('related', function(){\r\n\t\treturn {\r\n\t\t\tscope: false,\r\n\t\t\trestrict: 'E',\r\n\t\t\ttemplateUrl: '/common/directives/related/related.view.html',\r\n\t\t\tlink: function(scope, element, attr){\r\n\r\n\t\t\t\tscope.removeCurSelRelated = function(selRelateds, index){\r\n\t\t          selRelateds.splice(index, 1);\r\n\t\t        };\r\n\r\n\t\t\t\tscope.addThisRelated = function(selRelateds, thisRelated){\r\n\t\t          if(!thisRelated)\r\n\t\t            return false;\r\n\t\t          if(selRelateds.length < 1){\r\n\t\t            selRelateds.push(thisRelated[0]);\r\n\t\t          }else{\r\n\t\t            for(var i = 0; i < selRelateds.length; i++){\r\n\t\t              if(selRelateds[i].title != thisRelated[0].title){\r\n\t\t                if(i == (selRelateds.length-1)){\r\n\t\t                  selRelateds.push(thisRelated[0]);\r\n\t\t                }\r\n\t\t              }else{\r\n\t\t                break;\r\n\t\t              }\r\n\t\t            }\r\n\t\t          }\r\n\t\t        };\r\n\r\n\t\t        scope.getRelatedByKeyword = function(searchRelatedKeyword, rest){\r\n\t\t          if(searchRelatedKeyword){\r\n\t\t            scope.meanData.getRelatedByKeyword(searchRelatedKeyword).then(function(data){\r\n\t\t              var relateds = [];\r\n\t\t              data.forEach(function(object){\r\n\t\t                object.data.forEach(function(obj){\r\n\t\t                  relateds.push(obj);\r\n\t\t                });\r\n\t\t              });\r\n\t\t              if(rest == 'put'){\r\n\t\t                scope.relatedsUpdate = relateds;\r\n\t\t              }\r\n\t\t              if(rest == 'post'){\r\n\t\t                scope.relateds = relateds;\r\n\t\t              }\r\n\t\t            });\r\n\t\t          }\r\n\t\t        };\r\n\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n})();"],"sourceRoot":"/source/"}